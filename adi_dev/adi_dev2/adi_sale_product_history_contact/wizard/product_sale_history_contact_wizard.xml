<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Héritage de la vue wizard pour ajouter le champ Client et la colonne Client -->
    <record id="view_product_sale_history_wizard_contact" model="ir.ui.view">
        <field name="name">product.sale.history.wizard.form.contact</field>
        <field name="model">product.sale.history.wizard</field>
        <field name="inherit_id" ref="adi_sale_product_history.view_product_sale_history_wizard"/>
        <field name="arch" type="xml">
            <!-- Ajouter le champ Client avec bouton Tous les clients -->
            <xpath expr="//field[@name='date_to']" position="after">
                <field name="available_partner_ids" invisible="1"/>
                <field name="active_line_id" invisible="1"/>
                <label for="partner_id"/>
                <div class="o_row">
                    <field name="partner_id"
                           domain="[('id', 'in', available_partner_ids)]"
                           options="{'no_create': True, 'no_create_edit': True}"
                           placeholder="Sélectionner un client..."
                           class="oe_inline"/>
                    <button name="action_show_all_partners"
                            string="Tous les clients"
                            type="object"
                            class="btn-secondary"
                            icon="fa-users"/>
                </div>
            </xpath>

            <!-- Ajouter la colonne Client dans le tableau d'historique après la date -->
            <xpath expr="//field[@name='sale_history_ids']//tree//field[@name='date_order']" position="after">
                <field name="partner_id" string="Client"/>
            </xpath>
        </field>
    </record>
</odoo>
